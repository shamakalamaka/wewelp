<!-- –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
<div class="schedule-selector-container">
    <div class="schedule-options">
        <div class="schedule-option-group">
            <label class="schedule-label">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:</label>
            <div class="schedule-buttons">
                <button class="schedule-btn" data-type="daily" onclick="setScheduleType('daily')">
                    –ï–∂–µ–¥–Ω–µ–≤–Ω–æ
                </button>
                <button class="schedule-btn" data-type="once" onclick="setScheduleType('once')">
                    –û–¥–∏–Ω —Ä–∞–∑
                </button>
                <button class="schedule-btn" data-type="calendar" onclick="setScheduleType('calendar')">
                    –ü–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
                </button>
            </div>
        </div>
        
        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä -->
        <div class="calendar-selector" id="calendarSelector" style="display: none;">
            <div class="calendar-tabs">
                <button class="calendar-tab active" onclick="switchCalendarTab('weekdays')">
                    üìÖ –î–Ω–∏ –Ω–µ–¥–µ–ª–∏
                </button>
                <button class="calendar-tab" onclick="switchCalendarTab('dates')">
                    üìÜ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã
                </button>
            </div>
            
            <!-- –í—ã–±–æ—Ä –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ -->
            <div class="calendar-tab-content active" id="weekdaysTab">
                <div class="weekdays-selector">
                    <div class="weekday-option" data-day="1" onclick="toggleWeekday(1)">
                        <div class="weekday-circle">–ü–Ω</div>
                        <div class="weekday-label">–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫</div>
                    </div>
                    <div class="weekday-option" data-day="2" onclick="toggleWeekday(2)">
                        <div class="weekday-circle">–í—Ç</div>
                        <div class="weekday-label">–í—Ç–æ—Ä–Ω–∏–∫</div>
                    </div>
                    <div class="weekday-option" data-day="3" onclick="toggleWeekday(3)">
                        <div class="weekday-circle">–°—Ä</div>
                        <div class="weekday-label">–°—Ä–µ–¥–∞</div>
                    </div>
                    <div class="weekday-option" data-day="4" onclick="toggleWeekday(4)">
                        <div class="weekday-circle">–ß—Ç</div>
                        <div class="weekday-label">–ß–µ—Ç–≤–µ—Ä–≥</div>
                    </div>
                    <div class="weekday-option" data-day="5" onclick="toggleWeekday(5)">
                        <div class="weekday-circle">–ü—Ç</div>
                        <div class="weekday-label">–ü—è—Ç–Ω–∏—Ü–∞</div>
                    </div>
                    <div class="weekday-option" data-day="6" onclick="toggleWeekday(6)">
                        <div class="weekday-circle">–°–±</div>
                        <div class="weekday-label">–°—É–±–±–æ—Ç–∞</div>
                    </div>
                    <div class="weekday-option" data-day="0" onclick="toggleWeekday(0)">
                        <div class="weekday-circle">–í—Å</div>
                        <div class="weekday-label">–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</div>
                    </div>
                </div>
                
                <div class="quick-select-buttons">
                    <button class="quick-select-btn" onclick="selectWeekdays([1,2,3,4,5])">
                        –ë—É–¥–Ω–∏
                    </button>
                    <button class="quick-select-btn" onclick="selectWeekdays([6,0])">
                        –í—ã—Ö–æ–¥–Ω—ã–µ
                    </button>
                    <button class="quick-select-btn" onclick="selectWeekdays([1,2,3,4,5,6,0])">
                        –í—Å–µ –¥–Ω–∏
                    </button>
                    <button class="quick-select-btn" onclick="clearWeekdays()">
                        –û—á–∏—Å—Ç–∏—Ç—å
                    </button>
                </div>
            </div>
            
            <!-- –í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞—Ç -->
            <div class="calendar-tab-content" id="datesTab">
                <div class="date-picker-container">
                    <div class="calendar-header">
                        <button class="calendar-nav-btn" onclick="changeMonth(-1)">‚Äπ</button>
                        <div class="calendar-month-year" id="calendarMonthYear">
                            –Ø–Ω–≤–∞—Ä—å 2024
                        </div>
                        <button class="calendar-nav-btn" onclick="changeMonth(1)">‚Ä∫</button>
                    </div>
                    
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="selected-dates-display">
                        <div class="selected-dates-title">–í—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã:</div>
                        <div class="selected-dates-list" id="selectedDatesList">
                            <div class="no-dates-message">–î–∞—Ç—ã –Ω–µ –≤—ã–±—Ä–∞–Ω—ã</div>
                        </div>
                        <button class="clear-dates-btn" onclick="clearSelectedDates()">
                            –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ -->
        <div class="time-settings" id="timeSettings" style="display: none;">
            <div class="time-setting-group">
                <label class="time-label">–í—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:</label>
                <div class="time-inputs">
                    <input type="time" class="time-input" id="reminderTime" value="09:00">
                    <div class="time-presets">
                        <button class="time-preset-btn" onclick="setTime('09:00')">–£—Ç—Ä–æ–º</button>
                        <button class="time-preset-btn" onclick="setTime('14:00')">–î–Ω–µ–º</button>
                        <button class="time-preset-btn" onclick="setTime('18:00')">–í–µ—á–µ—Ä–æ–º</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü—Ä–µ–≤—å—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
        <div class="schedule-preview" id="schedulePreview">
            <div class="preview-title">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:</div>
            <div class="preview-content" id="previewContent">
                –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
            </div>
        </div>
    </div>
</div>

<style>
/* –°—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è */
.schedule-selector-container {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 12px;
    padding: 20px;
    margin-top: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.schedule-option-group {
    margin-bottom: 20px;
}

.schedule-label {
    display: block;
    font-size: 13px;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 10px;
    font-weight: 500;
}

.schedule-buttons {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.schedule-btn {
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    color: #fff;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
}

.schedule-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: #06b6d4;
}

.schedule-btn.active {
    background: #06b6d4;
    border-color: #06b6d4;
    color: white;
    box-shadow: 0 0 10px rgba(6, 182, 212, 0.4);
}

.calendar-selector {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 10px;
    padding: 20px;
    margin-top: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.calendar-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.calendar-tab {
    padding: 10px 16px;
    background: transparent;
    border: none;
    color: rgba(255, 255, 255, 0.6);
    cursor: pointer;
    font-size: 13px;
    font-weight: 500;
    border-bottom: 2px solid transparent;
    transition: all 0.3s;
}

.calendar-tab:hover {
    color: rgba(255, 255, 255, 0.8);
}

.calendar-tab.active {
    color: #06b6d4;
    border-bottom-color: #06b6d4;
}

.calendar-tab-content {
    display: none;
}

.calendar-tab-content.active {
    display: block;
}

.weekdays-selector {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 12px;
    margin-bottom: 20px;
}

.weekday-option {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px 8px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: center;
}

.weekday-option:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: #06b6d4;
}

.weekday-option.selected {
    background: rgba(6, 182, 212, 0.2);
    border-color: #06b6d4;
    box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
}

.weekday-circle {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #9333ea, #06b6d4);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
    color: white;
    margin-bottom: 8px;
}

.weekday-option.selected .weekday-circle {
    background: linear-gradient(135deg, #06b6d4, #0891b2);
    box-shadow: 0 0 15px rgba(6, 182, 212, 0.6);
}

.weekday-label {
    font-size: 11px;
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
}

.quick-select-buttons {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
    justify-content: center;
}

.quick-select-btn {
    padding: 6px 12px;
    background: rgba(147, 51, 234, 0.2);
    border: 1px solid rgba(147, 51, 234, 0.3);
    border-radius: 6px;
    color: #a855f7;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.3s;
    font-weight: 500;
}

.quick-select-btn:hover {
    background: rgba(147, 51, 234, 0.3);
    border-color: #9333ea;
}

.date-picker-container {
    max-width: 350px;
    margin: 0 auto;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 0 10px;
}

.calendar-nav-btn {
    width: 32px;
    height: 32px;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    transition: all 0.3s;
}

.calendar-nav-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    border-color: #06b6d4;
}

.calendar-month-year {
    font-size: 16px;
    font-weight: 600;
    color: white;
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 20px;
}

.calendar-day-header {
    padding: 8px 4px;
    text-align: center;
    font-size: 11px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.6);
    text-transform: uppercase;
}

.calendar-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    font-weight: 500;
    color: white;
    transition: all 0.3s;
    position: relative;
}

.calendar-day:hover {
    background: rgba(255, 255, 255, 0.1);
}

.calendar-day.other-month {
    color: rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.02);
}

.calendar-day.today {
    background: rgba(245, 158, 11, 0.3);
    border: 1px solid #f59e0b;
}

.calendar-day.selected {
    background: #06b6d4;
    color: white;
    box-shadow: 0 0 10px rgba(6, 182, 212, 0.5);
}

.selected-dates-display {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    padding: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.selected-dates-title {
    font-size: 13px;
    font-weight: 600;
    color: #06b6d4;
    margin-bottom: 10px;
}

.selected-dates-list {
    min-height: 40px;
    margin-bottom: 10px;
}

.no-dates-message {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.5);
    font-style: italic;
    text-align: center;
    padding: 10px;
}

.selected-date-item {
    display: inline-block;
    background: rgba(6, 182, 212, 0.2);
    border: 1px solid rgba(6, 182, 212, 0.3);
    border-radius: 6px;
    padding: 4px 8px;
    margin: 2px;
    font-size: 11px;
    color: #06b6d4;
}

.clear-dates-btn {
    width: 100%;
    padding: 8px;
    background: rgba(239, 68, 68, 0.2);
    border: 1px solid rgba(239, 68, 68, 0.3);
    border-radius: 6px;
    color: #ef4444;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.3s;
}

.clear-dates-btn:hover {
    background: rgba(239, 68, 68, 0.3);
}

.time-settings {
    background: rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.time-setting-group {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.time-label {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
}

.time-inputs {
    display: flex;
    gap: 10px;
    align-items: center;
    flex-wrap: wrap;
}

.time-input {
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    color: white;
    font-size: 13px;
    width: 120px;
}

.time-input:focus {
    outline: none;
    border-color: #06b6d4;
    box-shadow: 0 0 10px rgba(6, 182, 212, 0.3);
}

.time-presets {
    display: flex;
    gap: 5px;
}

.time-preset-btn {
    padding: 6px 10px;
    background: rgba(147, 51, 234, 0.2);
    border: 1px solid rgba(147, 51, 234, 0.3);
    border-radius: 4px;
    color: #a855f7;
    font-size: 11px;
    cursor: pointer;
    transition: all 0.3s;
}

.time-preset-btn:hover {
    background: rgba(147, 51, 234, 0.3);
}

.schedule-preview {
    background: rgba(6, 182, 212, 0.1);
    border: 1px solid rgba(6, 182, 212, 0.2);
    border-radius: 8px;
    padding: 15px;
    margin-top: 15px;
}

.preview-title {
    font-size: 13px;
    font-weight: 600;
    color: #06b6d4;
    margin-bottom: 8px;
}

.preview-content {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.4;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 768px) {
    .weekdays-selector {
        grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
        gap: 8px;
    }
    
    .weekday-circle {
        width: 32px;
        height: 32px;
        font-size: 10px;
    }
    
    .weekday-label {
        font-size: 10px;
    }
    
    .calendar-grid {
        gap: 1px;
        padding: 8px;
    }
    
    .calendar-day {
        font-size: 11px;
    }
    
    .time-inputs {
        flex-direction: column;
        align-items: stretch;
    }
    
    .time-input {
        width: 100%;
    }
}
</style>

<script>
// –°–∏—Å—Ç–µ–º–∞ —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
let currentScheduleType = null;
let selectedWeekdays = [];
let selectedDates = [];
let currentCalendarDate = new Date();

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∏–ø–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
function setScheduleType(type) {
    currentScheduleType = type;
    
    // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
    document.querySelectorAll('.schedule-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[data-type="${type}"]`).classList.add('active');
    
    // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä
    const calendarSelector = document.getElementById('calendarSelector');
    const timeSettings = document.getElementById('timeSettings');
    
    if (type === 'calendar') {
        calendarSelector.style.display = 'block';
        timeSettings.style.display = 'block';
    } else {
        calendarSelector.style.display = 'none';
        if (type === 'once') {
            timeSettings.style.display = 'block';
        } else {
            timeSettings.style.display = 'none';
        }
    }
    
    updateSchedulePreview();
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
function switchCalendarTab(tabName) {
    // –£–±—Ä–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
    document.querySelectorAll('.calendar-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelectorAll('.calendar-tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
    event.target.classList.add('active');
    document.getElementById(tabName + 'Tab').classList.add('active');
    
    updateSchedulePreview();
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–Ω—è –Ω–µ–¥–µ–ª–∏
function toggleWeekday(day) {
    const weekdayElement = document.querySelector(`[data-day="${day}"]`);
    
    if (selectedWeekdays.includes(day)) {
        selectedWeekdays = selectedWeekdays.filter(d => d !== day);
        weekdayElement.classList.remove('selected');
    } else {
        selectedWeekdays.push(day);
        weekdayElement.classList.add('selected');
    }
    
    updateSchedulePreview();
}

// –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
function selectWeekdays(days) {
    // –û—á–∏—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π –≤—ã–±–æ—Ä
    clearWeekdays();
    
    // –í—ã–±—Ä–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–Ω–∏
    days.forEach(day => {
        selectedWeekdays.push(day);
        document.querySelector(`[data-day="${day}"]`).classList.add('selected');
    });
    
    updateSchedulePreview();
}

// –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
function clearWeekdays() {
    selectedWeekdays = [];
    document.querySelectorAll('.weekday-option').forEach(option => {
        option.classList.remove('selected');
    });
    updateSchedulePreview();
}

// –°–º–µ–Ω–∞ –º–µ—Å—è—Ü–∞ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
function changeMonth(direction) {
    currentCalendarDate.setMonth(currentCalendarDate.getMonth() + direction);
    generateCalendar();
    updateSchedulePreview();
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
function generateCalendar() {
    const calendarGrid = document.getElementById('calendarGrid');
    const monthYearElement = document.getElementById('calendarMonthYear');
    
    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    
    // –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫
    const monthNames = [
        '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
        '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
    ];
    monthYearElement.textContent = `${monthNames[month]} ${year}`;
    
    // –û—á–∏—Å—Ç–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    calendarGrid.innerHTML = '';
    
    // –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
    const dayHeaders = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
    dayHeaders.forEach(day => {
        const dayHeader = document.createElement('div');
        dayHeader.className = 'calendar-day-header';
        dayHeader.textContent = day;
        calendarGrid.appendChild(dayHeader);
    });
    
    // –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const daysInMonth = lastDay.getDate();
    
    // –ü–æ–ª—É—á–∏—Ç—å –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è (0 = –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ, 1 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, ...)
    let startDay = firstDay.getDay();
    if (startDay === 0) startDay = 7; // –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ = 7
    startDay -= 1; // –°–¥–µ–ª–∞—Ç—å –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ = 0
    
    // –î–æ–±–∞–≤–∏—Ç—å –¥–Ω–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
    const prevMonth = new Date(year, month - 1, 0);
    const daysInPrevMonth = prevMonth.getDate();
    
    for (let i = startDay - 1; i >= 0; i--) {
        const dayElement = createCalendarDay(daysInPrevMonth - i, true);
        calendarGrid.appendChild(dayElement);
    }
    
    // –î–æ–±–∞–≤–∏—Ç—å –¥–Ω–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
    const today = new Date();
    for (let day = 1; day <= daysInMonth; day++) {
        const dayElement = createCalendarDay(day, false);
        
        // –û—Ç–º–µ—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
        if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate()) {
            dayElement.classList.add('today');
        }
        
        // –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã
        const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        if (selectedDates.includes(dateString)) {
            dayElement.classList.add('selected');
        }
        
        calendarGrid.appendChild(dayElement);
    }
    
    // –î–æ–±–∞–≤–∏—Ç—å –¥–Ω–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–µ—Å—è—Ü–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Å–µ—Ç–∫–∏
    const totalCells = calendarGrid.children.length - 7; // –í—ã—á–µ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
    const remainingCells = 42 - totalCells - 7; // 6 –Ω–µ–¥–µ–ª—å * 7 –¥–Ω–µ–π - –∑–∞–≥–æ–ª–æ–≤–∫–∏ - —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –¥–Ω–∏
    
    for (let day = 1; day <= remainingCells; day++) {
        const dayElement = createCalendarDay(day, true);
        calendarGrid.appendChild(dayElement);
    }
}

// –°–æ–∑–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –¥–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
function createCalendarDay(day, isOtherMonth) {
    const dayElement = document.createElement('div');
    dayElement.className = 'calendar-day';
    dayElement.textContent = day;
    
    if (isOtherMonth) {
        dayElement.classList.add('other-month');
    } else {
        dayElement.addEventListener('click', () => toggleDate(day));
    }
    
    return dayElement;
}

// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã
function toggleDate(day) {
    const year = currentCalendarDate.getFullYear();
    const month = currentCalendarDate.getMonth();
    const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    
    if (selectedDates.includes(dateString)) {
        selectedDates = selectedDates.filter(d => d !== dateString);
    } else {
        selectedDates.push(dateString);
    }
    
    generateCalendar();
    updateSelectedDatesList();
    updateSchedulePreview();
}

// –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞—Ç
function updateSelectedDatesList() {
    const listElement = document.getElementById('selectedDatesList');
    
    if (selectedDates.length === 0) {
        listElement.innerHTML = '<div class="no-dates-message">–î–∞—Ç—ã –Ω–µ –≤—ã–±—Ä–∞–Ω—ã</div>';
    } else {
        listElement.innerHTML = selectedDates
            .sort()
            .map(date => {
                const [year, month, day] = date.split('-');
                return `<div class="selected-date-item">${day}.${month}.${year}</div>`;
            })
            .join('');
    }
}

// –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã
function clearSelectedDates() {
    selectedDates = [];
    generateCalendar();
    updateSelectedDatesList();
    updateSchedulePreview();
}

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Ä–µ–º—è
function setTime(time) {
    document.getElementById('reminderTime').value = time;
    updateSchedulePreview();
}

// –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–≤—å—é —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
function updateSchedulePreview() {
    const previewContent = document.getElementById('previewContent');
    let preview = '';
    
    switch (currentScheduleType) {
        case 'daily':
            preview = '–ó–∞–¥–∞—á–∞ –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å';
            break;
            
        case 'once':
            const onceTime = document.getElementById('reminderTime').value;
            preview = `–ó–∞–¥–∞—á–∞ –ø–æ—è–≤–∏—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑${onceTime ? ` –≤ ${onceTime}` : ''}`;
            break;
            
        case 'calendar':
            const activeTab = document.querySelector('.calendar-tab.active');
            if (activeTab && activeTab.textContent.includes('–î–Ω–∏ –Ω–µ–¥–µ–ª–∏')) {
                if (selectedWeekdays.length === 0) {
                    preview = '–í—ã–±–µ—Ä–∏—Ç–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏';
                } else {
                    const dayNames = ['–í—Å', '–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±'];
                    const selectedDayNames = selectedWeekdays
                        .sort()
                        .map(day => dayNames[day])
                        .join(', ');
                    const calendarTime = document.getElementById('reminderTime').value;
                    preview = `–ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é: ${selectedDayNames}${calendarTime ? ` –≤ ${calendarTime}` : ''}`;
                }
            } else {
                if (selectedDates.length === 0) {
                    preview = '–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞—Ç—ã';
                } else {
                    const calendarTime = document.getElementById('reminderTime').value;
                    preview = `–í –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã (${selectedDates.length} –¥–∞—Ç)${calendarTime ? ` –≤ ${calendarTime}` : ''}`;
                }
            }
            break;
            
        default:
            preview = '–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è';
    }
    
    previewContent.textContent = preview;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    generateCalendar();
    updateSelectedDatesList();
    updateSchedulePreview();
});
</script>
